# Office Motion Lights
  - alias: Turn on office lights with motion
    trigger:
      platform: state
      entity_id: sensor.office_motion_motion_sensor
      to: 'on'
    condition:
      - condition: numeric_state
        entity_id: sensor.office_lux
        below: '6'
    action:
      service: light.turn_on
      data:
        entity_id: group.office_lights
        brightness: '255'

# Turn off Office Lights after one minute of no activity
  - alias: Turn office lights without motion one min
    trigger:
      platform: state
      entity_id: sensor.office_motion_motion_sensor
      to: 'off'
      for:
        minutes: 3
    condition:
      condition: and
      conditions:
        - condition: numeric_state
          entity_id: sensor.laptop_socket
          below: '3'
        - condition: template
          value_template: "{{ not is_state('sensor.steam_76561197976250572', 'online') }}" # NOT condition
    action:
      - service: light.turn_off
        data:
          entity_id: group.office_lights
          transition: 2
      - service: switch.turn_off
        entity_id: switch.office_fan

# Office Quick Brightness 100%
  - alias: Turn on office lights below lux
    trigger:
      platform: state
      entity_id: sensor.office_motion_motion_sensor
      to: 'on'
    condition:
      condition: and
      conditions:
        - condition: numeric_state
          entity_id: sensor.office_lux
          below: 16
        - condition: state
          entity_id: 'group.family'
          state: 'home'
        - condition: state
          entity_id: group.office_lights
          state: 'off'
        - condition: or
          conditions:
            - condition: state
              entity_id: sensor.steam_76561197976250572
              state: 'online'
            - condition: state
              entity_id: sensor.office_motion_motion_sensor
              state: 'on'
            - condition: numeric_state
              entity_id: sensor.laptop_socket
              above: 5
    action:
      service: light.turn_on
      data:
        entity_id: group.office_lights
        brightness: '255'

# Office Quick Brightness 75%
  - alias: Office Quick 75
    trigger:
      platform: state
      entity_id: sensor.office_motion_motion_sensor
      to: 'on'
    condition:
      condition: and
      conditions:
        - condition: numeric_state
          entity_id: sensor.office_lux
          above: 16
        - condition: numeric_state
          entity_id: sensor.office_lux
          below: 20
        - condition: state
          entity_id: 'group.family'
          state: 'home'
        - condition: state
          entity_id: group.office_lights
          state: 'off'
        - condition: or
          conditions:
            - condition: state
              entity_id: sensor.steam_76561197976250572
              state: 'online'
            - condition: state
              entity_id: sensor.office_motion_motion_sensor
              state: 'on'
            - condition: numeric_state
              entity_id: sensor.laptop_socket
              above: 5
    action:
      service: light.turn_on
      data:
        entity_id: group.office_lights
        brightness: '191'

# Office Quick Brightness 50%
  - alias: Office Quick 50
    trigger:
      platform: state
      entity_id: sensor.office_motion_motion_sensor
      to: 'on'
    condition:
      condition: and
      conditions:
        - condition: numeric_state
          entity_id: sensor.office_lux
          above: 20
        - condition: numeric_state
          entity_id: sensor.office_lux
          below: 28
        - condition: state
          entity_id: 'group.family'
          state: 'home'
        - condition: state
          entity_id: group.office_lights
          state: 'off'
        - condition: or
          conditions:
            - condition: state
              entity_id: sensor.steam_76561197976250572
              state: 'online'
            - condition: state
              entity_id: sensor.office_motion_motion_sensor
              state: 'on'
            - condition: numeric_state
              entity_id: sensor.laptop_socket
              above: 5
    action:
      service: light.turn_on
      data:
        entity_id: group.office_lights
        brightness: '153'

# Office Auto Brightness 100%
  - alias: Office Auto 100
    trigger:
      platform: time
      minutes: '/3'
      seconds: '00'
    condition:
      condition: and
      conditions:
        - condition: numeric_state
          entity_id: sensor.office_lux
          below: 16
        - condition: state
          entity_id: 'group.family'
          state: 'home'
        - condition: state
          entity_id: group.office_lights
          state: 'on'
        - condition: or
          conditions:
            - condition: state
              entity_id: sensor.steam_76561197976250572
              state: 'online'
            - condition: state
              entity_id: sensor.office_motion_motion_sensor
              state: 'on'
            - condition: numeric_state
              entity_id: sensor.laptop_socket
              above: 5
    action:
      service: light.turn_on
      data:
        entity_id: group.office_lights
        brightness: '255'
        transition: '30'

# Office Auto Brightness 75%
  - alias: Office Auto 75
    trigger:
      platform: time
      minutes: '/3'
      seconds: '00'
    condition:
      condition: and
      conditions:
        - condition: numeric_state
          entity_id: sensor.office_lux
          above: 16
        - condition: numeric_state
          entity_id: sensor.office_lux
          below: 21
        - condition: state
          entity_id: 'group.family'
          state: 'home'
        - condition: state
          entity_id: group.office_lights
          state: 'on'
        - condition: or
          conditions:
            - condition: state
              entity_id: sensor.steam_76561197976250572
              state: 'online'
            - condition: state
              entity_id: sensor.office_motion_motion_sensor
              state: 'on'
            - condition: numeric_state
              entity_id: sensor.laptop_socket
              above: 5
    action:
      service: light.turn_on
      data:
        entity_id: group.office_lights
        brightness: '191'
        transition: '30'

# Office Auto Brightness 50%
  - alias: Office Auto 50
    trigger:
      platform: time
      minutes: '/3'
      seconds: '00'
    condition:
      condition: and
      conditions:
        - condition: numeric_state
          entity_id: sensor.office_lux
          above: 21
        - condition: numeric_state
          entity_id: sensor.office_lux
          below: 28
        - condition: state
          entity_id: 'group.family'
          state: 'home'
        - condition: state
          entity_id: group.office_lights
          state: 'on'
        - condition: or
          conditions:
            - condition: state
              entity_id: sensor.steam_76561197976250572
              state: 'online'
            - condition: state
              entity_id: sensor.office_motion_motion_sensor
              state: 'on'
            - condition: numeric_state
              entity_id: sensor.laptop_socket
              above: 5
    action:
      service: light.turn_on
      data:
        entity_id: group.office_lights
        brightness: '153'
        transition: '30'

# Turn off Office lights above lux
  - alias: Turn off office lights above lux
    trigger:
      platform: numeric_state
      entity_id: sensor.office_lux
      above: 31
    condition:
      - condition: time
        after: '06:00:00'
        before: '20:00:00'
    action:
      - service: homeassistant.turn_off
        entity_id: group.office_lights
