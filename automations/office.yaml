# Playing on Steam
  - alias: "Steam Game Active"
    initial_state: 'on'
    trigger:
      - platform: template
        value_template: "{{ not is_state('sensor.steam_game', 'unavailable') }}" # NOT condition
      - platform: time_pattern
        minutes: '/5'
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: 'group.emily'
          state: 'not_home'
        - condition: state
          entity_id: 'group.sean'
          state: 'home'
        - condition: template
          value_template: "{{ not is_state('sensor.steam_game', 'unavailable') }}" # NOT condition
    action:
      - service: light.turn_off
        data:
          entity_id: light.living_room
          transition: 2
      - service: input_boolean.turn_off
        data:
          entity_id: input_boolean.living_room_occupied

# Turn on Office fan above temp
  - alias: "Turn on Fan above certain temp"
    initial_state: 'on'
    trigger:
      platform: state
      entity_id: binary_sensor.office_motion_motion_sensor
      to: 'on'
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: 'group.family'
          state: 'home'
        - condition: numeric_state
          entity_id: sensor.office_temperature_f
          above: '70'
        - condition: state
          entity_id: sensor.living_room_thermostat_hvac_state
          state: 'off'
        - condition: or
          conditions:
            - condition: state
              entity_id: 'sensor.steam_76561197976250572'
              state: 'online'
            - condition: numeric_state
              entity_id: sensor.laptop_socket
              above: 5
    action:
      service: switch.turn_on
      entity_id: switch.office_fan

# Turn off Office fan below temp
  - alias: "Turn off Fan below certain temp"
    initial_state: 'on'
    trigger:
      platform: numeric_state
      entity_id: sensor.office_temperature_f
      below: '68'
    action:
      service: switch.turn_off
      entity_id: switch.office_fan

# Turn off Office fan after 30 minutes
  - alias: "Turn off Office Fan"
    initial_state: 'on'
    trigger:
      platform: state
      entity_id: binary_sensor.office_motion_motion_sensor
      to: 'off'
      for:
        minutes: 30
    condition:
      condition: and
      conditions:
        - condition: state
          entity_id: 'group.family'
          state: 'home'
        - condition: or
          conditions:
            - condition: numeric_state
              entity_id: sensor.laptop_socket
              below: '3'
            - condition: template
              value_template: "{{ not is_state('sensor.steam_76561197976250572', 'online') }}" # NOT condition
    action:
      service: switch.turn_off
      entity_id: switch.office_fan
